
<div class="last-transactions-header row collapse" ng-init="txIndex = $index">
  <div class="large-9 small-7 columns size-14">
    <div ng-show="tx.comment">
      <i class="fi-comment-quotes size-18 vm"></i> 
      <span class="text-light">{{tx.comment}}</span>
    </div>
  </div>
  <div class="large-3 small-5 columns text-right">
    <span class="date-message">{{tx.createdTs | amCalendar}}</span>
  </div>
</div>

<div class="last-transactions-content">
  <div class="row" ng-repeat="out in tx.outs">
    <div class="large-3 medium-3 small-4 columns size-14">
      <b>{{out.value}} {{$root.wallet.settings.unitName}}</b>
      <span class="alt-currency gray">
        {{out.alternativeAmount}} {{out.alternativeIsoCode}}
      </span>
    </div>
    <div class="large-1 medium-1 small-1 columns fi-arrow-right"></div>
    <div class="large-8 medium-8 small-7 columns ellipsis size-12">
      <contact address="{{out.address}}" tooltip-popup-delay="500" tooltip tooltip-placement="right" />
    </div>
  </div>
  <div class="m10t" ng-show="!!tx.merchant">
    <div class="send-note">
      <span><b>{{tx.merchant.pr.pd.memo}}</b></span> <br>
      <span>Expires {{tx.merchant.pr.pd.expires * 1000 | amTimeAgo }} </span>
      <span ng-show="tx.merchant.domain">[{{tx.merchant.domain}}]</span>
      <span ng-show="!!tx.merchant.pr.ca"><i class="icon-locked size-14"></i> {{tx.merchant.pr.ca}}</span>
      <span ng-show="!tx.merchant.pr.ca" style="color:red;weight:bold;"><i class="fi-unlock"></i> Untrusted</span>
    </div>
  </div>
  <div class="line-b"></div>
</div>

<div class="last-transactions-footer">
  <div class="row collapse">
    <div class="large-5 medium-12 small-12 columns" ng-show="!tx.sentTs">
      <div ng-show="tx.signedBy[myId]">
        <button class="secondary tiny m0" ng-disabled="true"> <i class="fi-check"></i>
          <span translate>I signed</span>
        </button>
      </div>
      <div ng-show="tx.rejectedBy[myId]">
        <button class="warning tiny m0" ng-disabled="true"> <i class="fi-x"></i>
          <span translate>I rejected</span>
        </button>
      </div>
      <div ng-show="!tx.signedBy[myId] && !tx.rejectedBy[myId]">
        <div class="hide-for-small-only">
          <button class="primary tiny m0 m15r"  ng-click="sign(tx.ntxid)" ng-disabled="loading">
            <i class="fi-check"></i> <span translate>Sign</span>
          </button>
          <button class="warning tiny m0" ng-click="reject(tx.ntxid)" ng-disabled="loading">
            <i class="fi-x" ></i> <span translate>Reject</span>
          </button>
        </div>
        <div class="show-for-small-only row">
          <button class="primary tiny small-5 columns m10b"  ng-click="sign(tx.ntxid)" ng-disabled="loading">
            <i class="fi-check"></i> <span translate>Sign</span>
          </button>
          <button class="warning tiny small-5 columns m10b" ng-click="reject(tx.ntxid)" ng-disabled="loading">
            <i class="fi-x" ></i> <span translate>Reject</span>
          </button>
        </div>
      </div>
      <div ng-show="!tx.missingSignatures && !tx.sentTs">
        <button class="primary tiny m0"  ng-click="send(tx.ntxid)" ng-disabled="loading"> <i class="fi-upload-cloud"></i>
          <span translate>Broadcast Transaction</span>
        </button>
      </div>
    </div>

    <div class="large-7 columns small text-gray show-for-large-up text-right">
      <div>
        <strong translate>Fee</strong>: {{tx.fee}} {{$root.wallet.settings.unitName}}
      </div>
      <div class="m5t">
        <strong translate>Proposal ID</strong>: {{tx.ntxid}}
      </div>
    </div>
  </div>
</div>

<a class="missing-copayers" ng-click="tx.showDetails = !tx.showDetails">
  <span ng-show="!tx.finallyRejected && tx.missingSignatures==1">
    <i class="fi-torso"></i> 
    One signature missing
  </span> 
  <span ng-show="!tx.finallyRejected && tx.missingSignatures>1">
    <i class="icon-people"></i> 
    {{tx.missingSignatures}} signatures missing
  </span> 
  <i ng-class="{'icon-arrow-up':tx.showDetails, 'icon-arrow-down':!tx.showDetails}"></i>
</a>

<ul class="tx-copayers" ng-show="tx.showDetails">
  <li ng-repeat="c in tx.actionList">
    <span>
      <i ng-if="c.actions.rejected" class="fi-x icon-status icon-active-x m10r"></i>
      <i ng-if="c.actions.sign" class="fi-check icon-status icon-active-check m10r"></i>
      <i ng-if="!c.actions.sign && !c.actions.rejected && tx.missingSignatures" class="m10r fi-loop icon-rotate"></i>
    </span>
    <span>
      <i ng-if="c.actions.create" class="fi-crown icon-status icon-active m10r"></i>
    </span>
    <span>{{c.cId === $root.wallet.getMyCopayerId() ? 'Me' : $root.wallet.publicKeyRing.nicknameForCopayer(c.cId)}}</span>
  </li>
</ul>

